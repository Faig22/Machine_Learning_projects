# DCGAN
## Генерация лиц людей с помощью модели **DCGAN**
### Загрузка данных
Ноутбук был создан непосредственно в ***Kaggle*** и поэтому данные были предоставлены ими и загружены сразу в ноутбук (https://www.kaggle.com/datasets/504743cb487a5aed565ce14238c6343b7d650ffd28c071f03f2fd9b25819e6c9)
Далее изображения были обрезаны, переведены в тензоры и нормализованы, а после через класс **ImageFolder** они были загружены в даталоадер
### Архитектура модели
Модель была взята из статьи (https://arxiv.org/pdf/1511.06434.pdf)
1. Дискриминатор 
   ![image](https://github.com/Faig22/DCGAN/assets/95417164/0f2bdc58-bb49-49ed-ac9c-6a6ccab8fc6f)
   Он состоит из 5 ***conv*** - слоев, а на выходе одно число (вероятность того, что поданное изображение фейковое (*0*) или настоящее (*1*))
   
   Для убыстрения этапа обучения добавлен промежуточный слой с *64* каналами (***img_channels***) и убран последний слой с *1024* каналами
   
   Во всех слоях кроме первого и последнего была использована связка ***Conv + BatchNorm + LeakyRelu***. В первом и последнем слое были просто ***conv** слои.
   На выходе стоит сигмоида
   
2. Генератор
   ![image](https://github.com/Faig22/DCGAN/assets/95417164/b5d863a1-406a-4880-bc97-5d297ea44903)

   Аналогично дискриминатору он состоит из 5 ***conv*** - слоев, на входе гауссовский шум, на выходе сгенерируемое изображение

   Также для убыстрения обучения был убран первый слой из с *1024* каналами

   Во всех слоях кроме последнего была использована связка ***ConvTranspose2d (увеличивает размер изображений) + BatchNorm + Relu***. В последнем слое был просто ***convTranspose2d** слой.
   На выходе стоит гиперболический тангенс

### Инициализация модели
   Веса модели задаются из нормального распределения с мат. ожиданием 0 и дисперсией 0.02

### Обучение
   
     Гиперпараметры:
     batch_size = 128
     epochs = 30
     noise_dim = 100 - размер шума, подаваемый на вход генератора
     img_size = 64 - размер изображения, который подается на вход дискриминатора
     learning rate = 0.0002 - обучающий коэффициент у оптимизатора Adam
     beta_1 = 0.5 - коэффициент, используемый для вычисления средних значений градиента у оптимизатора Adam
     beta_2 = 0.999 - коэффициент, используемый для вычисления квадратов градиента у оптимизатора Adam
### Результаты
   ![image](https://github.com/Faig22/DCGAN/assets/95417164/b759981d-b545-4900-a1dc-fdf084b2dab6)

   Отличная генерация)
     
